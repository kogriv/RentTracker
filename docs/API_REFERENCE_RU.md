# Ğ¡Ğ¿Ñ€Ğ°Ğ²Ğ¾Ñ‡Ğ½Ğ¸Ğº API Ğ¸ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğµ, ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°Ğ¼ Ğ¸ API Ğ¢Ñ€ĞµĞºĞµÑ€Ğ° ĞŸĞ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ Ğ·Ğ° Ğ“Ğ°Ñ€Ğ°Ğ¶Ğ¸.

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### ĞĞ±Ñ‰Ğ°Ñ ÑÑ…ĞµĞ¼Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Interface Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   CLI Interface â”‚  â”‚  Future Web UI  â”‚  â”‚ Future Bot   â”‚  â”‚
â”‚  â”‚   (Click)       â”‚  â”‚                 â”‚  â”‚ Interface    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Application Layer                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ProcessPayments â”‚  â”‚ GenerateReport  â”‚  â”‚ Future Use   â”‚  â”‚
â”‚  â”‚    UseCase      â”‚  â”‚    UseCase      â”‚  â”‚    Cases     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Domain Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Models     â”‚  â”‚   Services   â”‚  â”‚    Exceptions     â”‚   â”‚
â”‚  â”‚ Garage       â”‚  â”‚ PaymentMatcherâ”‚  â”‚ ParseError       â”‚   â”‚
â”‚  â”‚ Payment      â”‚  â”‚ DateCalculatorâ”‚  â”‚ ValidationError  â”‚   â”‚
â”‚  â”‚ Transaction  â”‚  â”‚ StatusDeterminerâ”‚ â”‚ DataIntegrityErr â”‚   â”‚
â”‚  â”‚ Report       â”‚  â”‚              â”‚  â”‚                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Infrastructure Layer                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Parsers    â”‚  â”‚ File Handlersâ”‚  â”‚   Configuration   â”‚   â”‚
â”‚  â”‚ GarageParser â”‚  â”‚ ExcelWriter  â”‚  â”‚ ConfigManager    â”‚   â”‚
â”‚  â”‚ SberbankParserâ”‚  â”‚ LogHandler   â”‚  â”‚ LocalizationMgr  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

1. **Clean Architecture** - Ñ‡ĞµÑ‚ĞºĞ¾Ğµ Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ ÑĞ»Ğ¾ĞµĞ² Ñ Ğ¸Ğ½Ğ²ĞµÑ€ÑĞ¸ĞµĞ¹ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
2. **Dependency Injection** - Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¿ĞµÑ€ĞµĞ´Ğ°ÑÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ñ‹
3. **Single Responsibility** - ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ Ğ¸Ğ¼ĞµĞµÑ‚ Ğ¾Ğ´Ğ½Ñƒ Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ
4. **Interface Segregation** - Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑ‹ Ğ´Ğ»Ñ Ñ€Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚Ğ¸
5. **Domain-Driven Design** - Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ² Domain ÑĞ»Ğ¾Ğµ

## ğŸ“¦ ĞœĞ¾Ğ´ÑƒĞ»Ğ¸ Ğ¸ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

### Domain Layer (`src/core/`)

#### Models

##### Garage
```python
from dataclasses import dataclass
from datetime import date
from decimal import Decimal

@dataclass(frozen=True)
class Garage:
    """ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ³Ğ°Ñ€Ğ°Ğ¶Ğ° Ñ Ğ°Ñ€ĞµĞ½Ğ´Ğ¾Ğ¹"""
    id: int
    monthly_rent: Decimal
    start_date: date
    payment_day: int
    
    def __post_init__(self):
        # Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
        if self.id <= 0:
            raise ValueError("ID Ğ³Ğ°Ñ€Ğ°Ğ¶Ğ° Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼")
        if self.monthly_rent <= 0:
            raise ValueError("Ğ¡ÑƒĞ¼Ğ¼Ğ° Ğ°Ñ€ĞµĞ½Ğ´Ñ‹ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹")
        if not (1 <= self.payment_day <= 31):
            raise ValueError("Ğ”ĞµĞ½ÑŒ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ° Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ñ‚ 1 Ğ´Ğ¾ 31")
```

##### Payment
```python
from dataclasses import dataclass
from datetime import date
from decimal import Decimal
from typing import Optional
from enum import Enum

class PaymentStatus(Enum):
    """Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹"""
    RECEIVED = "received"       # ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½
    OVERDUE = "overdue"         # ĞŸÑ€Ğ¾ÑÑ€Ğ¾Ñ‡ĞµĞ½
    PENDING = "pending"         # ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ
    NOT_DUE = "not_due"         # Ğ¡Ñ€Ğ¾Ğº Ğ½Ğµ Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ¸Ğ»
    UNCLEAR = "unclear"         # ĞĞµÑÑĞ½Ğ¾

@dataclass(frozen=True)
class Payment:
    """ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°"""
    garage_id: int
    expected_amount: Decimal
    expected_date: date
    status: PaymentStatus
    actual_amount: Optional[Decimal] = None
    actual_date: Optional[date] = None
    days_overdue: int = 0
    notes: str = ""
```

##### Transaction
```python
@dataclass(frozen=True)
class Transaction:
    """ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ±Ğ°Ğ½ĞºĞ¾Ğ²ÑĞºĞ¾Ğ¹ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸"""
    date: date
    amount: Decimal
    description: str
    category: str = ""
    source_row: int = 0
    
    def matches_amount(self, expected_amount: Decimal, tolerance: Decimal = Decimal('0.01')) -> bool:
        """ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ñ ÑÑƒĞ¼Ğ¼Ñ‹ Ñ Ğ´Ğ¾Ğ¿ÑƒÑĞºĞ¾Ğ¼"""
        return abs(abs(self.amount) - expected_amount) <= tolerance
```

##### PaymentPeriod
```python
@dataclass(frozen=True) 
class PaymentPeriod:
    """ĞŸĞµÑ€Ğ¸Ğ¾Ğ´ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ Ğ¸Ğ· Ğ±Ğ°Ğ½ĞºĞ¾Ğ²ÑĞºĞ¾Ğ¹ Ğ²Ñ‹Ğ¿Ğ¸ÑĞºĞ¸"""
    start_date: date
    end_date: date
    source_text: str
    
    @property
    def target_month(self) -> date:
        """Ğ¦ĞµĞ»ĞµĞ²Ğ¾Ğ¹ Ğ¼ĞµÑÑÑ† Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° (Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ start_date)"""
        return self.start_date.replace(day=1)
        
    @property
    def analysis_date(self) -> date:
        """Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ğ°Ñ Ğ´Ğ°Ñ‚Ğ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° (end_date)"""
        return self.end_date
```

#### Services

##### PaymentMatcher
```python
class PaymentMatcher:
    """Ğ¡ĞµÑ€Ğ²Ğ¸Ñ ÑĞ¾Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹"""
    
    def __init__(self, 
                 search_window_days: int = 7,
                 grace_period_days: int = 3,
                 i18n: LocalizationManager = None):
        self.search_window_days = search_window_days
        self.grace_period_days = grace_period_days
        self.i18n = i18n or LocalizationManager()
    
    def match_payments(self, 
                      garages: List[Garage],
                      transactions: List[Transaction], 
                      payment_period: PaymentPeriod,
                      analysis_date: date) -> List[Payment]:
        """
        ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ ÑĞ¾Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
        
        Args:
            garages: Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ³Ğ°Ñ€Ğ°Ğ¶ĞµĞ¹
            transactions: Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¹
            payment_period: ĞŸĞµÑ€Ğ¸Ğ¾Ğ´ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
            analysis_date: Ğ”Ğ°Ñ‚Ğ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°
            
        Returns:
            Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
        """
        # Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ²ÑƒÑ…ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
        # 1. Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ² Ğ¾ĞºĞ½Ğµ
        # 2. Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾ Ğ²ÑĞµĞ¼Ñƒ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ñƒ
        
    def _find_matching_transaction(self, 
                                  garage: Garage,
                                  expected_date: date,
                                  transactions: List[Transaction]) -> Tuple[Optional[Transaction], str]:
        """ĞŸĞ¾Ğ¸ÑĞº ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ¹ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ³Ğ°Ñ€Ğ°Ğ¶Ğ°"""
        
    def _create_matched_payment(self, 
                               payment: Payment, 
                               transaction: Transaction, 
                               conflict_info: str) -> Payment:
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ° Ñ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ½Ğ¾Ğ¹ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸ĞµĞ¹"""
```

##### StatusDeterminer
```python
class StatusDeterminer:
    """ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹"""
    
    def __init__(self, grace_period_days: int = 3):
        self.grace_period_days = grace_period_days
    
    def determine_status(self, 
                        expected_date: date, 
                        analysis_date: date,
                        transaction_found: bool) -> PaymentStatus:
        """
        ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°
        
        Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°:
        - RECEIVED: Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ñ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°
        - OVERDUE: analysis_date > expected_date + grace_period Ğ˜ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ñ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°
        - PENDING: expected_date <= analysis_date <= expected_date + grace_period Ğ˜ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ñ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°
        - NOT_DUE: analysis_date < expected_date
        """
        
    def calculate_days_overdue(self, 
                              expected_date: date,
                              actual_date: Optional[date],
                              analysis_date: date,
                              status: PaymentStatus) -> int:
        """Ğ Ğ°ÑÑ‡ĞµÑ‚ Ğ´Ğ½ĞµĞ¹ Ğ¿Ñ€Ğ¾ÑÑ€Ğ¾Ñ‡ĞºĞ¸"""
```

### Application Layer (`src/application/`)

#### Use Cases

##### ProcessPaymentsUseCase
```python
class ProcessPaymentsUseCase:
    """Use case Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹"""
    
    def __init__(self, 
                 parser_factory: ParserFactory,
                 payment_matcher: PaymentMatcher,
                 search_window_days: int = 7,
                 grace_period_days: int = 3):
        
    def execute(self, request: PaymentProcessRequest) -> PaymentProcessResponse:
        """
        Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
        
        Steps:
        1. ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ ÑĞ¿Ñ€Ğ°Ğ²Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ° Ğ³Ğ°Ñ€Ğ°Ğ¶ĞµĞ¹
        2. ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ±Ğ°Ğ½ĞºĞ¾Ğ²ÑĞºĞ¾Ğ¹ Ğ²Ñ‹Ğ¿Ğ¸ÑĞºĞ¸  
        3. Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
        4. Ğ¡Ğ¾Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
        5. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°
        """
```

##### GenerateReportUseCase
```python
class GenerateReportUseCase:
    """Use case Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ²"""
    
    def execute(self, request: ReportGenerationRequest) -> ReportGenerationResponse:
        """Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Excel Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ° Ñ Ğ»Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹"""
```

#### DTOs

##### PaymentProcessRequest
```python
@dataclass
class PaymentProcessRequest:
    """Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ½Ğ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹"""
    garage_file: Path
    statement_file: Path
    analysis_date: Optional[date] = None
    output_file: Optional[Path] = None
```

##### PaymentProcessResponse
```python
@dataclass
class PaymentProcessResponse:
    """ĞÑ‚Ğ²ĞµÑ‚ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹"""
    report: PaymentReport
    warnings: List[str]
    processing_time: float
    output_file: Path
```

### Infrastructure Layer (`src/infrastructure/`)

#### Parsers

##### GarageRegistryParser
```python
class GarageRegistryParser:
    """ĞŸĞ°Ñ€ÑĞµÑ€ ÑĞ¿Ñ€Ğ°Ğ²Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ° Ğ³Ğ°Ñ€Ğ°Ğ¶ĞµĞ¹"""
    
    def parse(self, file_path: Path) -> List[Garage]:
        """
        ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Excel Ñ„Ğ°Ğ¹Ğ»Ğ° Ñ Ğ³Ğ°Ñ€Ğ°Ğ¶Ğ°Ğ¼Ğ¸
        
        Expected format:
        | ID | Ğ¡ÑƒĞ¼Ğ¼Ğ° Ğ°Ñ€ĞµĞ½Ğ´Ñ‹ | Ğ”Ğ°Ñ‚Ğ° Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° | Ğ”ĞµĞ½ÑŒ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ° |
        """
        
    def _validate_garage_data(self, row_data: dict) -> None:
        """Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ³Ğ°Ñ€Ğ°Ğ¶Ğ°"""
```

##### SberbankStatementParser
```python
class SberbankStatementParser:
    """ĞŸĞ°Ñ€ÑĞµÑ€ Ğ²Ñ‹Ğ¿Ğ¸ÑĞºĞ¸ Ğ¡Ğ±ĞµÑ€Ğ±Ğ°Ğ½ĞºĞ°"""
    
    def parse(self, file_path: Path) -> List[Transaction]:
        """ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Excel Ğ²Ñ‹Ğ¿Ğ¸ÑĞºĞ¸"""
        
    def extract_payment_period(self, file_path: Path) -> Optional[PaymentPeriod]:
        """
        Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ° Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ° Ğ²Ñ‹Ğ¿Ğ¸ÑĞºĞ¸
        
        Ğ˜Ñ‰ĞµÑ‚ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹: "Ğ˜Ñ‚Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸ÑĞ¼ Ñ Ğ”Ğ”.ĞœĞœ.Ğ“Ğ“Ğ“Ğ“ Ğ¿Ğ¾ Ğ”Ğ”.ĞœĞœ.Ğ“Ğ“Ğ“Ğ“"
        """
```

##### ParserFactory
```python
class ParserFactory:
    """Ğ¤Ğ°Ğ±Ñ€Ğ¸ĞºĞ° Ğ¿Ğ°Ñ€ÑĞµÑ€Ğ¾Ğ²"""
    
    def create_garage_parser(self) -> GarageRegistryParser:
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ñ€ÑĞµÑ€Ğ° Ğ³Ğ°Ñ€Ğ°Ğ¶ĞµĞ¹"""
        
    def create_statement_parser(self, bank_type: str = "sberbank") -> StatementParser:
        """Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ñ€ÑĞµÑ€Ğ° Ğ²Ñ‹Ğ¿Ğ¸ÑĞºĞ¸ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ Ğ±Ğ°Ğ½ĞºĞ°"""
```

#### File Handlers

##### ExcelReportWriter
```python
class ExcelReportWriter:
    """Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Excel Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ²"""
    
    def write_report(self, 
                    report: PaymentReport, 
                    file_path: Path,
                    localization_manager: LocalizationManager) -> None:
        """
        Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ»Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Excel Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°
        
        Structure:
        - Metadata (generation date, analysis date)
        - Headers (localized)
        - Payment data
        - Summary statistics
        """
        
    def _format_currency(self, amount: Decimal) -> str:
        """Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²Ğ°Ğ»ÑÑ‚Ğ½Ñ‹Ñ… ÑÑƒĞ¼Ğ¼"""
        
    def _format_date(self, date_obj: date) -> str:
        """Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ°Ñ‚"""
```

#### Localization

##### LocalizationManager
```python
class LocalizationManager:
    """ĞœĞµĞ½ĞµĞ´Ğ¶ĞµÑ€ Ğ»Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸"""
    
    def __init__(self, language: str = 'en'):
        self.current_language = language
        self.messages = self._load_messages()
        
    def get(self, key: str, **kwargs) -> str:
        """
        ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ»Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
        
        Args:
            key: ĞšĞ»ÑÑ‡ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: "status.received")
            **kwargs: ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ´Ğ»Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
            
        Returns:
            Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
        """
        
    def switch_language(self, language: str) -> None:
        """ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ·Ñ‹ĞºĞ°"""
        
    def get_available_languages(self) -> List[str]:
        """Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… ÑĞ·Ñ‹ĞºĞ¾Ğ²"""
```

### Interface Layer (`src/interfaces/`)

#### CLI Application

##### CLIApp
```python
class CLIApp:
    """Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ CLI Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ"""
    
    def __init__(self, config: dict, localization_manager: LocalizationManager):
        self.config = config
        self.i18n = localization_manager
        self._setup_services()
        
    def run(self) -> None:
        """Ğ—Ğ°Ğ¿ÑƒÑĞº Click CLI Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°"""
        
    @click.command('process-payments')
    @click.option('--garage-file', required=True, type=click.Path(exists=True))
    @click.option('--statement-file', required=True, type=click.Path(exists=True))
    @click.option('--output', '-o', type=click.Path())
    @click.option('--analysis-date', type=click.DateTime(formats=['%Y-%m-%d']))
    def process_payments(self, garage_file, statement_file, output, analysis_date):
        """ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹"""
```

## ğŸ”Œ API Reference

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑ‹

#### Parser Interface
```python
from abc import ABC, abstractmethod
from typing import List
from pathlib import Path

class StatementParser(ABC):
    """Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ¿Ğ°Ñ€ÑĞµÑ€Ğ° Ğ±Ğ°Ğ½ĞºĞ¾Ğ²ÑĞºĞ¸Ñ… Ğ²Ñ‹Ğ¿Ğ¸ÑĞ¾Ğº"""
    
    @abstractmethod
    def parse(self, file_path: Path) -> List[Transaction]:
        """ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ²Ñ‹Ğ¿Ğ¸ÑĞºĞ¸"""
        pass
        
    @abstractmethod
    def extract_payment_period(self, file_path: Path) -> Optional[PaymentPeriod]:
        """Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹"""
        pass
```

#### Report Writer Interface
```python
class ReportWriter(ABC):
    """Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ²"""
    
    @abstractmethod
    def write_report(self, report: PaymentReport, file_path: Path) -> None:
        """Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ° Ğ² Ñ„Ğ°Ğ¹Ğ»"""
        pass
```

### ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

#### Configuration Schema
```yaml
# config/default_config.yaml
localization:
  default_language: "ru"      # Ğ¯Ğ·Ñ‹Ğº Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
  fallback_language: "en"     # Ğ ĞµĞ·ĞµÑ€Ğ²Ğ½Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº

payment_matching:
  search_window_days: 7       # ĞĞºĞ½Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ (Ğ´Ğ½Ğ¸)
  grace_period_days: 3        # Ğ›ÑŒĞ³Ğ¾Ñ‚Ğ½Ñ‹Ğ¹ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´ (Ğ´Ğ½Ğ¸)
  
parsing:
  search_window_days: 7       # Ğ”Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾Ğ¹ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
  grace_period_days: 3
  
file_handling:
  max_file_size_mb: 100       # ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ñ„Ğ°Ğ¹Ğ»Ğ°
  supported_formats:          # ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹
    - ".xlsx"
    - ".xls"
```

#### Environment Variables
```bash
# Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°
GARAGE_TRACKER_LANG=ru|en

# Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ  
GARAGE_TRACKER_LOG_LEVEL=DEBUG|INFO|WARNING|ERROR

# Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
GARAGE_TRACKER_CONFIG_DIR=/path/to/config

# Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
GARAGE_TRACKER_DATA_DIR=/path/to/data
```

### Ğ›Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ ĞºĞ»ÑÑ‡Ğ¸

#### Status Messages
```json
{
  "status": {
    "received": "ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½",
    "overdue": "ĞŸÑ€Ğ¾ÑÑ€Ğ¾Ñ‡ĞµĞ½", 
    "pending": "ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ",
    "not_due": "Ğ¡Ñ€Ğ¾Ğº Ğ½Ğµ Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ¸Ğ»",
    "unclear": "ĞĞµÑÑĞ½Ğ¾"
  }
}
```

#### Payment Notes
```json
{
  "notes": {
    "payment_found": "ĞŸĞ»Ğ°Ñ‚ĞµĞ¶ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½",
    "payment_not_found": "ĞŸĞ»Ğ°Ñ‚ĞµĞ¶ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½",
    "wide_search_match": "ĞĞ°Ğ¹Ğ´ĞµĞ½ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğ¼ Ğ¿Ğ¾Ğ¸ÑĞºĞ¾Ğ¼",
    "multiple_matches": "ĞĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾",
    "closest_match": "Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾ Ğ±Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞµĞµ Ğº Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ğ¾Ğ¹ Ğ´Ğ°Ñ‚Ğµ",
    "amount_shared": "ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ ÑÑƒĞ¼Ğ¼ Ñ Ğ³Ğ°Ñ€Ğ°Ğ¶Ğ°Ğ¼Ğ¸: {garages}"
  }
}
```

#### Summary Messages
```json
{
  "summary": {
    "total_garages": "Ğ’ÑĞµĞ³Ğ¾ Ğ³Ğ°Ñ€Ğ°Ğ¶ĞµĞ¹: {count}",
    "received_count": "ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾: {count}",
    "overdue_count": "ĞŸÑ€Ğ¾ÑÑ€Ğ¾Ñ‡ĞµĞ½Ğ¾: {count}",
    "pending_count": "ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ: {count}",
    "not_due_count": "Ğ¡Ñ€Ğ¾Ğº Ğ½Ğµ Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ¸Ğ»: {count}",
    "collection_rate": "ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚ ÑĞ±Ğ¾Ñ€Ğ°: {rate}%",
    "expected_amount": "ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ°: {amount} Ñ€ÑƒĞ±.",
    "received_amount": "ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ°: {amount} Ñ€ÑƒĞ±."
  }
}
```

## ğŸ§ª Testing Framework

### Unit Tests Structure
```
tests/
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ test_garage.py
â”‚   â”‚   â”œâ”€â”€ test_payment.py
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â”œâ”€â”€ test_payment_matcher.py
â”‚   â”‚       â””â”€â”€ test_status_determiner.py
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â””â”€â”€ test_process_payments_usecase.py
â”‚   â””â”€â”€ infrastructure/
â”‚       â”œâ”€â”€ test_excel_writer.py
â”‚       â”œâ”€â”€ test_localization.py
â”‚       â””â”€â”€ parsers/
â”‚           â”œâ”€â”€ test_garage_parser.py
â”‚           â””â”€â”€ test_sberbank_parser.py
â””â”€â”€ integration/
    â”œâ”€â”€ test_end_to_end.py
    â””â”€â”€ test_file_processing.py
```

### Test Utilities
```python
# tests/conftest.py
import pytest
from pathlib import Path
from src.core.models.garage import Garage
from src.infrastructure.localization.i18n import LocalizationManager

@pytest.fixture
def sample_garage():
    """Ğ¤Ğ¸ĞºÑÑ‚ÑƒÑ€Ğ° Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ³Ğ°Ñ€Ğ°Ğ¶Ğ°"""
    return Garage(
        id=1,
        monthly_rent=Decimal('5000'),
        start_date=date(2024, 1, 1),
        payment_day=1
    )

@pytest.fixture
def localization_manager():
    """Ğ¤Ğ¸ĞºÑÑ‚ÑƒÑ€Ğ° Ğ¼ĞµĞ½ĞµĞ´Ğ¶ĞµÑ€Ğ° Ğ»Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸"""
    return LocalizationManager('ru')

@pytest.fixture
def temp_excel_file(tmp_path):
    """Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Excel Ñ„Ğ°Ğ¹Ğ»Ğ°"""
    file_path = tmp_path / "test.xlsx"
    # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°
    return file_path
```

## ğŸ“ˆ Performance Considerations

### ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

1. **Lazy Loading** - Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ÑÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
2. **Memory Management** - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ² Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
3. **Caching** - ĞºĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ»Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
4. **Batch Processing** - Ğ¿Ğ°ĞºĞµÑ‚Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¹

### ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ

```python
# Ğ”Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ streaming
def parse_large_statement(file_path: Path) -> Generator[Transaction, None, None]:
    """Streaming Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ²Ñ‹Ğ¿Ğ¸ÑĞ¾Ğº"""
    wb = openpyxl.load_workbook(file_path, read_only=True)
    ws = wb.active
    
    for row in ws.iter_rows(min_row=2, values_only=True):
        if row[0]:  # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‡Ñ‚Ğ¾ ÑÑ‚Ñ€Ğ¾ĞºĞ° Ğ½Ğµ Ğ¿ÑƒÑÑ‚Ğ°Ñ
            yield Transaction(
                date=row[0],
                amount=Decimal(str(row[1])),
                description=row[2] or ""
            )
```

## ğŸ”’ Error Handling

### Exception Hierarchy
```python
class GarageTrackerError(Exception):
    """Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ"""
    pass

class ParseError(GarageTrackerError):
    """ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²"""
    pass

class ValidationError(GarageTrackerError):
    """ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…"""
    pass

class DataIntegrityError(GarageTrackerError):
    """ĞÑˆĞ¸Ğ±ĞºĞ¸ Ñ†ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…"""
    pass

class ConfigurationError(GarageTrackerError):
    """ĞÑˆĞ¸Ğ±ĞºĞ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸"""
    pass
```

### Error Recovery Strategies
```python
def safe_parse_amount(value: str) -> Optional[Decimal]:
    """Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² Decimal"""
    try:
        return Decimal(str(value).replace(',', '.'))
    except (ValueError, TypeError, InvalidOperation):
        logger.warning(f"Could not parse amount: {value}")
        return None

def retry_with_backoff(func, max_retries: int = 3):
    """ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ ÑĞºÑĞ¿Ğ¾Ğ½ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹"""
    for attempt in range(max_retries):
        try:
            return func()
        except Exception as e:
            if attempt == max_retries - 1:
                raise
            time.sleep(2 ** attempt)
```

## ğŸš€ Extension Points

### Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ±Ğ°Ğ½ĞºĞ°

1. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¿Ğ°Ñ€ÑĞµÑ€**:
```python
class NewBankStatementParser(StatementParser):
    """ĞŸĞ°Ñ€ÑĞµÑ€ Ğ´Ğ»Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ±Ğ°Ğ½ĞºĞ°"""
    
    def parse(self, file_path: Path) -> List[Transaction]:
        # Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ°
        pass
        
    def extract_payment_period(self, file_path: Path) -> Optional[PaymentPeriod]:
        # Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ°
        pass
```

2. **ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ Ñ„Ğ°Ğ±Ñ€Ğ¸ĞºÑƒ**:
```python
def create_statement_parser(self, bank_type: str = "sberbank") -> StatementParser:
    if bank_type == "sberbank":
        return SberbankStatementParser()
    elif bank_type == "newbank":
        return NewBankStatementParser()
    else:
        raise ValueError(f"Unsupported bank type: {bank_type}")
```

### Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ° Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°

1. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ writer**:
```python
class PDFReportWriter(ReportWriter):
    """Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ PDF Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ²"""
    
    def write_report(self, report: PaymentReport, file_path: Path) -> None:
        # Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ PDF
        pass
```

2. **ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ use case**:
```python
def execute(self, request: ReportGenerationRequest) -> ReportGenerationResponse:
    if request.format == "excel":
        writer = ExcelReportWriter()
    elif request.format == "pdf":
        writer = PDFReportWriter()
    # ...
```

### Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ²ĞµĞ±-Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°

```python
# src/interfaces/web/app.py
from flask import Flask, request, jsonify

class WebApp:
    """Flask Ğ²ĞµĞ±-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ"""
    
    def __init__(self, process_payments_usecase: ProcessPaymentsUseCase):
        self.app = Flask(__name__)
        self.process_payments_usecase = process_payments_usecase
        self._setup_routes()
    
    def _setup_routes(self):
        @self.app.route('/api/process-payments', methods=['POST'])
        def process_payments():
            # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ‡ĞµÑ€ĞµĞ· Ñ‚Ğ¾Ñ‚ Ğ¶Ğµ use case
            request_data = request.get_json()
            # ...
```

---

*Ğ¡Ğ¿Ñ€Ğ°Ğ²Ğ¾Ñ‡Ğ½Ğ¸Ğº API Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½: ĞĞ²Ğ³ÑƒÑÑ‚ 2025*
*Ğ’ĞµÑ€ÑĞ¸Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹: 3.0 (Clean Architecture Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ»Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹)*